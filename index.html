<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Secret Anonymous Board</title>
<style>
  body { font-family: Arial; background: #121212; color: #eee; padding: 20px; display: flex; justify-content: center; }
  #container { width: 500px; }
  .hidden { display: none; }
  input { width: 100%; padding: 8px; margin: 5px 0; border-radius: 5px; border: none; }
  button { padding: 8px 12px; border-radius: 5px; border: none; background: #6200ee; color: white; cursor: pointer; }
  button:hover { background: #3700b3; }
  #messages { border: 1px solid #444; padding: 10px; height: 300px; overflow-y: scroll; margin-bottom: 10px; border-radius: 8px; background: #1e1e1e; }
  #logoutBtn { margin-top: 10px; background: #b00020; }
  #logoutBtn:hover { background: #7f0000; }
</style>
</head>
<body>
<div id="container">

  <!-- Login Form -->
  <div id="loginForm">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button id="loginBtn">Login</button>
    <p id="loginError" style="color:red;"></p>
  </div>

  <!-- Message Board -->
  <div id="board" class="hidden">
    <h2>Secret Anonymous Board</h2>
    <div id="messages">Loading messages...</div>
    <input type="text" id="msgInput" placeholder="Type your message...">
    <button id="sendBtn">Send</button>
    <button id="logoutBtn">Logout</button>
  </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
import { getDatabase, ref, onValue, push } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

// ðŸ”¹ Hidden credentials (Base64)
const encUser = "Z3JvdXAyNg=="; // Base64 of "group26"
const encPass = "NjY2";         // Base64 of "666"

const actualUser = atob(encUser);
const actualPass = atob(encPass);

// ðŸ”¹ Hidden Firebase config (Base64)
const encFirebase = "eyJhcGlLZXkiOiAiQUl6YVNkN0N2bXNYSXYzZkJ1X1NwWE5uY2xMOUQtNTZoNkktRjFhRnpkR1giLCJhdXRoRG9tYWluIjoic2VjLTkxMWMyLmZpcmViYXNlcHJvamVjdC5hcHAuZ29vZ2xlLmNvbSIsImRhdGFiYXNlVVJMIjoiaHR0cHM6Ly9zZWMtOTExYzItZGVmYXVsdC1ydGRiLmFzaWEtc291dGhlYXN0MS5maXJlYmFzZWRhdGFiYXNlLmFwcCIsInByb2plY3RJZCI6InNlYy05MTFjMiIsInN0b3JhZ2VCdWNrZXQiOiJzZWMtOTExYzIuZmlyZWJhc3Rlc3RvcmFnZS5hcHAiLCJtZXNzYWdpbmdTZW5kZXJJZCI6IjkzNzczMjAxNTA2MiIsImFwcElkIjoiMTkzNzczMjAxNTA2Mjp3ZWI6YWM0MGIzYzYxZTk2Nzg5ZjAxNWE3NyIsIm1lYXN1cmVtZW50SWQiOiJHLU4zVlAyMDhPUk0ifQ==";
const firebaseConfig = JSON.parse(atob(encFirebase));

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// DOM Elements
const loginForm = document.getElementById("loginForm");
const loginBtn = document.getElementById("loginBtn");
const loginError = document.getElementById("loginError");

const board = document.getElementById("board");
const messagesDiv = document.getElementById("messages");
const msgInput = document.getElementById("msgInput");
const sendBtn = document.getElementById("sendBtn");
const logoutBtn = document.getElementById("logoutBtn");

// ðŸ”¹ Login Logic
loginBtn.onclick = () => {
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value.trim();

  if(username === actualUser && password === actualPass) {
    loginForm.classList.add("hidden");
    board.classList.remove("hidden");
    startBoard();
  } else {
    loginError.textContent = "Wrong username or password!";
  }
};

// ðŸ”¹ Board Logic
function startBoard() {
  const messagesRef = ref(db, "messages");

  onValue(messagesRef, (snapshot) => {
    const data = snapshot.val();
    messagesDiv.innerHTML = "";
    if (data) {
      Object.values(data).forEach(msg => {
        const p = document.createElement("p");
        p.textContent = msg.text;
        messagesDiv.appendChild(p);
      });
    } else {
      messagesDiv.innerHTML = "No messages yet.";
    }
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  });

  sendBtn.onclick = () => {
    const text = msgInput.value.trim();
    if (!text) return;
    push(messagesRef, { text, timestamp: Date.now() });
    msgInput.value = "";
  };
}

// ðŸ”¹ Logout
logoutBtn.onclick = () => {
  board.classList.add("hidden");
  loginForm.classList.remove("hidden");
  document.getElementById("username").value = "";
  document.getElementById("password").value = "";
};
</script>
</body>
</html>
